@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@

@*@model ExpressBase.Web.Models.RetValObj*@

@{
    @using Newtonsoft.Json;
    @using ExpressBase.Common;
    @using ExpressBase.Objects;
    var dvobj = EbSerializers.Json_Serialize(ViewBag.data);
    //var dvobj = JsonConvert.SerializeObject(ViewBag.data);
    var tableId = "dv" + ViewBag.data.DataSourceRefId;
}

<link rel="stylesheet" type="text/css" href="~/css/splitWindow.css">
<script src="~/js/splitWindow.js" type="text/javascript"></script>
<style>
    .tools {
        border: none;
        background-color: #489097;
        color: white;
    }
</style>
<script>
    $(function () {
        var sw = new splitWindow("parent-div", "sidediv", "contBox", "pGrid");
    });
</script>

@*<div class="container-fluid my-container">
    @{
        Html.RenderPartial("_PageheaderDev");
    }
    <div class="row">
        <div class="toolbar-com"><button class="btn" id="new"><i class="fa fa-plus" aria-hidden="true"></i></button> </div>
    </div>
    <div class="row" id="parent-div">
    </div>
</div>*@

<div class='tablecontainer' style='background-color:rgb(260,260,260);'>
    <ul class='nav nav-tabs' id='table_tabs'>
        <li class='nav-item active'>
            <a class='nav-link' href='#@(tableId + "_tab_1")' data-toggle='tab' style="padding: 6px 4px !important;"><i class='fa fa-home' aria-hidden='true'></i>&nbsp; Home</a>
        </li>
    </ul>
    <div class='tab-content' id='table_tabcontent'>
        <div id='@(tableId + "_tab_1")' class='tab-pane active'>

            <div class="container-fluid my-container">
                <div class="row">
                    <div class="toolbar-com" id='Toolbar'>
                        <button class="btn" id="new"><i class="fa fa-plus" aria-hidden="true"></i></button> 
                        @if (ViewBag.data.EbDataSource.FilterDialog == null)
                        {
                            <button id='btnGo' class='btn btn-primary'>Run</button>
                        }
                    </div>
                </div>
                <div class="row"  id="parent-div">
                    <div class="col-md-2 no-padd fd" id="sidediv" style="display:block">
                        <div class="min-btn">
                            <button class="btn-tb-com pull-right" onclick="fdBoxMin();" id = 'fd-min-btn' ><i class="fa fa-caret-left fa-lg" aria-hidden="true"></i></button>
                        </div>
                        @{
                            if (ViewBag.data.EbDataSource.FilterDialog != null)
                            {
                                @await Component.InvokeAsync("ParameterDiv", new { paramDiv = ViewBag.data.EbDataSource.FilterDialog });
                                <button id='btnGo' class='btn btn-primary' style='float: right;margin-top: 4px;'>Run</button>
                            }
                        }
                    </div>
                    <div class="col-md-8 no-padd cont-wnd" id="contBox">
                        <div class="sub-w" id="sub-w">
                            <div class='sub-windows' id='sub0'>
                                <div class='sub-windows-head' id="indi-toolbar">
                                    <div class='pull-right' style='margin-top: 3px;'>
                                        <button class='head-btn'><i class='fa fa-minus' aria-hidden='true'></i></button>
                                        <button class='head-btn'><i class='fa fa-thumb-tack' aria-hidden='true'></i></button>
                                        <button class='head-btn'><i class='fa fa-times' aria-hidden='true'></i></button>
                                    </div>
                                </div>
                                @*<div id='TableControls_@(tableId + "_1")' class='well well-sm' style='margin-bottom:5px!important;'>
                                    <label class="dvname">@ViewBag.data.Name</label>
                                    <button id='btnGo' class='btn btn-primary' style='float: right;'>Run</button>
                                </div>*@
                                <div id='@(tableId+"_1container")'>
                                    <div id='@(tableId+"_1TableColumns4Drag")' style='border:1px solid;display:none;height:100%;min-height: 400px;overflow-y: auto;'>
                                    </div>
                                    <div style='width:auto;' id='@(tableId+"_1divcont")'>
                                        <div id='@(tableId+"_1ColumnsDispaly")' style='display:none;' class='colCont'></div>
                                        <div id='@(tableId+"_1ColumnsGrouping")' style='display:none;margin-top: 1px;' class='colCont'></div>
                                        <table id='@(tableId+"_1")' class='table table-striped table-bordered'></table>
                                    </div>
                                    @*<div id='@(tableId+"_1TableColumnsPPGrid")' style='display:none;height:100%;min-height: 400px;overflow-y: auto;'></div>*@
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    @*<div class="col-md-2 pg no-padd pull-right" id="pGrid">
                        <div class="min-btn">
                            <button class="btn-tb-com" onclick="pgBoxMin();" id='pg-min'><i class="fa fa-caret-right fa-lg" aria-hidden="true"></i></button>
                        </div>
                    </div>*@
                </div>
            </div>



            @*<div id='graphcontainer_tab@(tableId+"_1")'>
                    <div style='height: 50px;margin-bottom: 5px!important;' class='well well-sm'>
                        <label class="dvname">@ViewBag.data.Name</label>
                        <div id='btnColumnCollapse@(tableId+"_1")' class='btn btn-default' style='float: right;'>
                            <i class='fa fa-cog' aria-hidden='true'></i>
                        </div>
                        <div class='dropdown' id='graphDropdown_tab@(tableId+"_1")' style='display: inline-block;padding-top: 1px;float:right'>
                            <button class='btn btn-default dropdown-toggle' type='button' data-toggle='dropdown'>
                                <span class='caret'></span>
                            </button>
                            <ul class='dropdown-menu'>
                                <li><a href='#'><i class='fa fa-line-chart custom'></i> Line</a></li>
                                <li><a href='#'><i class='fa fa-bar-chart custom'></i> Bar </a></li>
                                <li><a href='#'><i class='fa fa-area-chart custom'></i> AreaFilled </a></li>
                                <li><a href='#'><i class='fa fa-pie-chart custom'></i> pie </a></li>
                                <li><a href='#'> doughnut </a></li>
                            </ul>
                        </div>
                        <button id='reset_zoom@(tableId+"_1")' class='btn btn-default' style='float: right;'>Reset zoom</button>

                    </div>
                    <div id='columns4Drag@(tableId+"_1")' style='display:none;'>
                        <div style='display: inline-block;'>
                            <label class='nav-header disabled'><center><strong>Columns</strong></center><center><font size='1'>Darg n Drop to X or Y Axis</font></center></label>
                            <input id='searchColumn@(tableId+"_1")' type='text' class='form-control' placeholder='search for column' />
                            <ul class='list-group' style='height: 450px; overflow-y: auto;'></ul>
                        </div>
                        <div style='display: inline-block;vertical-align: top;width: 806px;'>
                            <div class='input-group'>
                                <span class='input-group-addon' id='basic-addon3'>X-Axis</span>
                                <div class='form-control' style='padding: 4px;height:33px' id='X_col_name@(tableId+"_1")'></div>
                            </div>
                            <div class='input-group' style='padding-top: 1px;'>
                                <span class='input-group-addon' id='basic-addon3'>Y-Axis</span>
                                <div class='form-control' style='padding: 4px;height:33px' id='Y_col_name@(tableId+"_1")'></div>
                            </div>
                        </div>
                    </div>
                    <canvas id='myChart@(tableId+"_1")' width='auto' height='auto'></canvas>
                </div>*@
        </div>
    </div>
</div>

@*@section EbHead {
        <script>
            @Html.Raw(ViewBag.HtmlHead);
        </script>
    }*@
<script>
    @*if ('@ViewBag.data.EbDataSource.FilterDialog' != null) {
        $('#filterBox').append("<button id='btnGo' class='btn btn-primary' style='float: right;margin-top: 4px;'>Run</button>");
    }
    else {
        alert("gjgg");
        $("#Toolbar").append("<button id='btnGo' class='btn btn-primary'>Run</button>");
    }*@
    @Html.Raw(ViewBag.HtmlHead)
    var sett = @Html.Raw(dvobj);
    var meta = @Html.Raw(ViewBag.meta);
    var ebdtable = new EbDataTable({
        ds_id: '@ViewBag.data.DataSourceRefId',
        ss_url: '@ViewBag.ServiceUrl',
        tid: '@(tableId+"_1")',
        login:'@ViewBag.wc',
        settings:sett,
        meta: meta,
        dvRefId:'@ViewBag.dvRefId'
        //fnKeyUpCallback:
    });
</script>

