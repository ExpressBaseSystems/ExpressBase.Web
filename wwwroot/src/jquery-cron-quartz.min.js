(function(e){function n(d,c){for(var a="",k=0;k<d.length;k++){var l=d[k];null!=c&&(l=c[k]);a+="<option value='"+l+"'>"+d[k]+"</option>\n"}return a}function h(d,c,a){for(var k="",l=d;l<=c;l++)d=a&&10>l?"0"+l:l,k+="<option value='"+l+"'>"+d+"</option>\n";return k}function m(d,c,a){e(f.container).addClass(c.tag).appendTo(d);d.children("."+c.tag).append(c.inputs);"function"===typeof a&&a()}var f={period:'<div class="cron-select-period"><label></label><select class="cron-period-select"></select></div>',
startTime:'<div class="cron-input cron-start-time">Start time <select class="cron-clock-hour"></select>:<select class="cron-clock-minute"></select></div>',container:'<div class="cron-input"></div>',minutes:{tag:"cron-minutes",inputs:['<p>Every <select class="cron-minutes-select"></select> minutes(s)</p>']},hourly:{tag:"cron-hourly",inputs:['<p><input type="radio" name="hourlyType" value="every"> Every <select class="cron-hourly-select"></select> hour(s)</p>','<p><input type="radio" name="hourlyType" value="clock"> Every day at <select class="cron-hourly-hour"></select>:<select class="cron-hourly-minute"></select></p>']},
daily:{tag:"cron-daily",inputs:['<p><input type="radio" name="dailyType" value="every"> Every <select class="cron-daily-select"></select> day(s)</p>','<p><input type="radio" name="dailyType" value="clock"> Every week day</p>']},weekly:{tag:"cron-weekly",inputs:['<p><input type="checkbox" name="dayOfWeekMon"> Monday  <input type="checkbox" name="dayOfWeekTue"> Tuesday  <input type="checkbox" name="dayOfWeekWed"> Wednesday  <input type="checkbox" name="dayOfWeekThu"> Thursday</p>','<p><input type="checkbox" name="dayOfWeekFri"> Friday  <input type="checkbox" name="dayOfWeekSat"> Saturday  <input type="checkbox" name="dayOfWeekSun"> Sunday</p>']},
monthly:{tag:"cron-monthly",inputs:['<p><input type="radio" name="monthlyType" value="byDay"> Day <select class="cron-monthly-day"></select> of every <select class="cron-monthly-month"></select> month(s)</p>','<p><input type="radio" name="monthlyType" value="byWeek"> The <select class="cron-monthly-nth-day"></select> <select class="cron-monthly-day-of-week"></select> of every <select class="cron-monthly-month-by-week"></select> month(s)</p>']},yearly:{tag:"cron-yearly",inputs:['<p><input type="radio" name="yearlyType" value="byDay"> Every <select class="cron-yearly-month"></select> <select class="cron-yearly-day"></select></p>',
'<p><input type="radio" name="yearlyType" value="byWeek"> The <select class="cron-yearly-nth-day"></select> <select class="cron-yearly-day-of-week"></select> of <select class="cron-yearly-month-by-week"></select></p>']}},x=n("Minutes Hourly Daily Weekly Monthly Yearly".split(" ")),y=h(1,60),z=h(1,24),A=h(1,100),p=h(0,59,!0),q=h(0,23,!0),r=h(1,31),t=n("January February March April May June July August September October November December".split(" "),[1,2,3,4,5,6,7,8,9,10,11,12]),u=h(1,12),v=n(["First",
"Second","Third","Forth"],[1,2,3,4]),w=n("Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),"MON TUE WED THU FRI SAT SUN".split(" ")),B=function(){var d=e(this).val(),c=e(this).parent();c.siblings("div.cron-input").hide();c.siblings().find("select option").removeAttr("selected");c.siblings().find("select option:first").attr("selected","selected");c.siblings("div.cron-start-time").show();c.siblings("div.cron-start-time").children("select.cron-clock-hour").val("12");switch(d){case "Minutes":c.siblings("div.cron-minutes").show().find("select.cron-minutes-select").val("1");
c.siblings("div.cron-start-time").hide();break;case "Hourly":d=c.siblings("div.cron-hourly");d.show().find("input[name=hourlyType][value=every]").prop("checked",!0);d.find("select.cron-hourly-hour").val("12");c.siblings("div.cron-start-time").hide();break;case "Daily":c.siblings("div.cron-daily").show().find("input[name=dailyType][value=every]").prop("checked",!0);break;case "Weekly":c.siblings("div.cron-weekly").show().find("input[type=checkbox]").prop("checked",!1);break;case "Monthly":c.siblings("div.cron-monthly").show().find("input[name=monthlyType][value=byDay]").prop("checked",
!0);break;case "Yearly":c.siblings("div.cron-yearly").show().find("input[name=yearlyType][value=byDay]").prop("checked",!0)}};e.cronBuilder=function(d,c){var a=this;a.$el=e(d);a.el=d;a.$el.data("cronBuilder",a);a.init=function(){a.options=e.extend({},e.cronBuilder.defaultOptions,c);a.$el.append(f.period);a.$el.find("div.cron-select-period label").text(a.options.selectorLabel);a.$el.find("select.cron-period-select").append(x).bind("change",B);m(a.$el,f.minutes,function(){a.$el.find("select.cron-minutes-select").append(y)});
m(a.$el,f.hourly,function(){a.$el.find("select.cron-hourly-select").append(z);a.$el.find("select.cron-hourly-hour").append(q);a.$el.find("select.cron-hourly-minute").append(p)});m(a.$el,f.daily,function(){a.$el.find("select.cron-daily-select").append(A)});m(a.$el,f.weekly);m(a.$el,f.monthly,function(){a.$el.find("select.cron-monthly-day").append(r);a.$el.find("select.cron-monthly-month").append(u);a.$el.find("select.cron-monthly-nth-day").append(v);a.$el.find("select.cron-monthly-day-of-week").append(w);
a.$el.find("select.cron-monthly-month-by-week").append(u)});m(a.$el,f.yearly,function(){a.$el.find("select.cron-yearly-month").append(t);a.$el.find("select.cron-yearly-day").append(r);a.$el.find("select.cron-yearly-nth-day").append(v);a.$el.find("select.cron-yearly-day-of-week").append(w);a.$el.find("select.cron-yearly-month-by-week").append(t)});a.$el.append(f.startTime);a.$el.find("select.cron-clock-hour").append(q);a.$el.find("select.cron-clock-minute").append(p);"function"===typeof a.options.onChange&&
a.$el.find("select, input").change(function(){a.options.onChange(a.getExpression())});a.$el.find("select.cron-period-select").triggerHandler("change")};a.getExpression=function(){var c="?",d="*",e="*",f=a.$el.find("select.cron-clock-minute").val(),h=a.$el.find("select.cron-clock-hour").val();switch(a.$el.find("select.cron-period-select").val()){case "Minutes":var b=a.$el.find("div.cron-minutes"),f=b.find("select.cron-minutes-select").val(),f=1<f?"0/"+f:"*",h="*";break;case "Hourly":b=a.$el.find("div.cron-hourly");
b.find("input[name=hourlyType][value=every]").is(":checked")?(f=0,h="*",b=b.find("select.cron-hourly-select").val(),1<b&&(h="0/"+b)):(f=b.find("select.cron-hourly-minute").val(),h=b.find("select.cron-hourly-hour").val());break;case "Daily":b=a.$el.find("div.cron-daily");b.find("input[name=dailyType][value=every]").is(":checked")?(b=b.find("select.cron-daily-select").val(),1<b&&(e="1/"+b)):(e="?",c="MON-FRI");break;case "Weekly":var b=a.$el.find("div.cron-weekly"),g=[];b.find("input[name=dayOfWeekMon]").is(":checked")&&
g.push("MON");b.find("input[name=dayOfWeekTue]").is(":checked")&&g.push("TUE");b.find("input[name=dayOfWeekWed]").is(":checked")&&g.push("WED");b.find("input[name=dayOfWeekThu]").is(":checked")&&g.push("THU");b.find("input[name=dayOfWeekFri]").is(":checked")&&g.push("FRI");b.find("input[name=dayOfWeekSat]").is(":checked")&&g.push("SAT");b.find("input[name=dayOfWeekSun]").is(":checked")&&g.push("SUN");c="*";e="?";7>g.length&&0<g.length&&(c=g.join(","));break;case "Monthly":b=a.$el.find("div.cron-monthly");
b.find("input[name=monthlyType][value=byDay]").is(":checked")?(d="*",g=b.find("select.cron-monthly-month").val(),e=b.find("select.cron-monthly-day").val(),c="?"):(c=b.find("select.cron-monthly-day-of-week").val()+"#"+b.find("select.cron-monthly-nth-day").val(),g=b.find("select.cron-monthly-month-by-week").val(),e="?");1<g&&(d="1/"+g);break;case "Yearly":b=a.$el.find("div.cron-yearly"),b.find("input[name=yearlyType][value=byDay]").is(":checked")?(e=b.find("select.cron-yearly-day").val(),d=b.find("select.cron-yearly-month").val(),
c="?"):(c=b.find("select.cron-yearly-day-of-week").val()+"#"+b.find("select.cron-yearly-nth-day").val(),d=b.find("select.cron-yearly-month-by-week").val(),e="?")}return[0,f,h,e,d,c,"*"].join(" ")};a.init()};e.cronBuilder.defaultOptions={selectorLabel:"Select period: "};e.fn.cronBuilder=function(d){return this.each(function(){new e.cronBuilder(this,d)})}})(jQuery);