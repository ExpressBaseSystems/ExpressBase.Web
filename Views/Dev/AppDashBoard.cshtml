@using ExpressBase.Objects.ServiceStack_Artifacts
@using ExpressBase.Common
@using Microsoft.AspNetCore.Mvc;
@using ExpressBase.Common.Structures;
@using Newtonsoft.Json;
@using ExpressBase.Common.Application;
@{
    Layout = "~/Views/Shared/LayoutInner.cshtml";
    string domurl = string.Empty;
    string jssrc = string.Empty;
    var sol_cid = ViewBag.cid;
    var solutionid = ViewBag.cide;
    if (ViewBag.Env == "Development")
    {
        domurl = "http://" + solutionid + ".localhost:41500";
        jssrc = "https://" + sol_cid + ".localhost:41502";
    }
    if (ViewBag.Env == "Staging")
    {
        domurl = "https://" + solutionid + "." + RoutingConstants.STAGEHOST;
        jssrc = "https://" + sol_cid + "." + RoutingConstants.STAGEHOST;
    }
    if (ViewBag.Env == "Production")
    {
        domurl = "https://" + solutionid + ".expressbase.com";
        jssrc = "https://" + sol_cid + ".expressbase.com";
    }
}

@section StyleSheet{
    <style>
        .demodpdiv {
            width: 75px;
            height: 75px;
            cursor: pointer;
            display: inline-block;
        }

            .demodpdiv:hover {
                box-shadow: 1px 1px 2px 2px #ccc;
            }
    </style>
    <link rel="stylesheet" href="~/css/EbCommonStyles/AppDashBoardStyles.css" asp-append-version="true">
    <link rel="stylesheet" href="~/css/ColorPicker/Gradient.css" asp-append-version="true">
}

@section JavaScript{
    <script src="~/js/EbDashBoards/AppDashBoard.js" type="text/javascript"></script>
    <script src="~/js/ColorPicker/GradientColorPicker.js" type="text/javascript"></script>
}
<script>
    new EbHeader().setName("Application Configuration");
</script>
<div class="row s-dash-container h-100">
    @{
        Dictionary<int, TypeWrap> list = ViewBag.ObjectCollection;
        var appinfo = ViewBag.AppInfo;
        var apptype = (EbApplicationTypes)appinfo.AppType;
        string typeIcon = null;

        if (appinfo.AppType == 1) { typeIcon = "/images/svg/grid-world.svg"; }

        else if (appinfo.AppType == 2) { typeIcon = "/images/svg/smartphone-call.svg"; }

        else if (appinfo.AppType == 3) { typeIcon = "/images/svg/chat1.svg"; }
    }
    <div class="s-dash-workplace tenant_workpane">
        <div class="col-md-12 col-lg-12 s-dash-solution-desc border-style-none">
            <div class="col-md-10 col-xs-12 pd-0">
                <h4 class="mr-t-0"><span class="fa @appinfo.Icon appicon_style"></span> @appinfo.Name </h4>
                <p class="small">@appinfo.Description</p>
                <p class="small mr-b-0"><img class="apptype_icon" src="@typeIcon" /><span>@apptype</span> Application</p>
            </div>
            <div class="col-md-2 col-lg-2 col-xs-12 pd-0 s-dash-btnwraper">
                @{
                    if (ViewBag.ObjectsCount <= 0)
                    {
                        <a href="@Url.Action("DeleteApplication", "Dev",new { Id = appinfo.Id })" class="ebbtn eb_btn-sm" style="background: #e65f66;color: white;margin-left: 10px;">
                            <i class="fa fa-trash" style="margin-right:5px"></i> Delete
                        </a>
                    }
                }
                <a href='@Url.Action("CreateApplication", "Dev",new { Id = appinfo.Id,Type = appinfo.AppType})' class="ebbtn eb_btn-sm eb_btnblue">
                    <i class="fa fa-edit" style="margin-right:5px"></i> Edit Application
                </a>
            </div>
        </div>
        <div class="col-md-12 pd-0 s-dash-workplace-tabs">
            <ul class="nav nav-tabs eb-styledTab" role="tablist">
                <li class="nav-item active">
                    <a class="nav-link" data-toggle="tab" href="#Objects" role="tab">
                        <i class="fa fa-list"></i> Objects
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#Appearance" role="tab">
                        <i class="fa fa-picture-o"></i> Appearance
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#home" role="tab">
                        <i class="fa fa-cog"></i> Settings
                    </a>
                </li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane active appdash_obj_container" id="Objects" role="tabpanel">
                    <div class="raw">
                        <button type="button" class="ebbtn eb_btn-sm eb_btngreen" data-toggle="modal" data-target="#newObjectmdl">
                            New Object
                        </button>
                        @*<button class="ebbtn eb_btn-sm eb_btnplain" style="margin-right:10px" id="ExportBtn">Export</button>*@
                        <div class="input-group eb-search-box" style="margin-right: 10px;">
                            <span class="input-group-addon"><i class="fa fa-search"></i></span>
                            <input type="text" id="obj_search_input" class="form-control" placeholder="Search object">
                        </div>
                    </div>
                    @*<div class="not-found text-center" style="margin-top: 150px;">No Objects...</div>*@
                    <div class="raw-obj-container">
                        <div class="col-md-3 col-lg-3 col-xs-6 col-sm-4 pd-0 sidebar-objtypes">
                            <ul style="list-style:none;" class="pd-0">
                                <li class="sidebar-objtypes-listitem">
                                    <a class="raw-obj-type" id="ebobject_type_all" link-id="ebobject_type_wrapper_all">
                                        <span class="fa fa-list raw-obj-type-icon"></span>
                                        <span class="name">All (@ViewBag.ObjectsCount)</span>
                                    </a>
                                </li>
                                @{
                                    int _k = (list.Keys.Count > 0) ? list.Keys.First() : 0;

                                    foreach (EbObjectType objectType in EbObjectTypes.Enumerator)
                                    {
                                        if (objectType.IsAvailableIn(apptype))
                                        {
                                            string active = (_k == objectType.IntCode) ? "active_type" : "";
                                            int o_c = list.ContainsKey(objectType.IntCode) ? list[objectType.IntCode].Objects.Count : 0;

                                            <li class="sidebar-objtypes-listitem @active">
                                                <a class="raw-obj-type" id="ebobject_type_@objectType.IntCode" link-id="ebobject_type_wrapper_@objectType.IntCode">
                                                    <span class="fa @objectType.Icon raw-obj-type-icon"></span>
                                                    <span class="name">@(objectType.Alias + "s") (@o_c)</span>
                                                </a>
                                            </li>
                                        }
                                    }
                                }
                            </ul>
                        </div>
                        <div class="col-md-9 col-lg-9 col-xs-6 col-sm-8 pd-r-0 raw-object-pane">
                            @{
                                foreach (KeyValuePair<int, TypeWrap> kp in list)
                                {
                                    <div class="raw-objectTypeWrprBlk" id="ebobject_type_wrapper_@kp.Key">
                                        <div class="raw-objectTypeWrpr">
                                            @{
                                                foreach (ObjWrap ob in kp.Value.Objects)
                                                {
                                                    <div class="objitems obj_linkthumb">
                                                        <a class="object_container obj_link" href='../Eb_Object/Index?objid=@ob.Id&objtype=@ob.EbObjectType'>
                                                            <div class='col-md-11 col-lg-11 col-sm-11 pd-0'>
                                                                <h4 class='head4'>@ob.DisplayName</h4>
                                                                <p class='text-justify'>@(string.IsNullOrEmpty(ob.Description) ? "no description" : ob.Description)</p>
                                                                <div class="label_container">
                                                                    <span class="label">@ob.EbType</span>
                                                                </div>
                                                            </div>
                                                            <input type="checkbox" objid="@ob.Id" name="ExportMark" class="ExportMark" />
                                                        </a>
                                                    </div>
                                                }
                                            }
                                        </div>
                                    </div>
                                }

                                <div class="raw-objectTypeWrprBlk" id="ebobject_type_wrapper_all">
                                    <div class="raw-objectTypeWrpr">
                                        @foreach (KeyValuePair<int, TypeWrap> kpall in list)
                                        {
                                            foreach (ObjWrap oball in kpall.Value.Objects)
                                            {
                                                <div class="objitems obj_linkthumb">
                                                    <a class="object_container obj_link" href='../Eb_Object/Index?objid=@oball.Id&objtype=@oball.EbObjectType'>
                                                        <div class='col-md-11 col-lg-11 col-sm-11 pd-0'>
                                                            <h4 class='head4'>@oball.DisplayName</h4>
                                                            <p class='text-justify'>@(string.IsNullOrEmpty(oball.Description) ? "no description" : oball.Description)</p>
                                                            <div class="label_container">
                                                                <span class="label">@oball.EbType</span>
                                                            </div>
                                                        </div>
                                                        <input type="checkbox" objid="@oball.Id" name="ExportMark" class="ExportMark" />
                                                    </a>
                                                </div>
                                            }
                                        }
                                    </div>
                                </div>

                                if (list.Keys.Count <= 0)
                                {
                                    <div class="empty-objects">Objects list empty.</div>
                                }
                            }
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="Appearance" role="tabpanel">
                    @if (appinfo.AppType == 3)
                    {
                        EbBotSettings settings = ViewBag.AppSettings;
                        var bot_name_txt = appinfo.Name;
                        var bot_wc_msg = "";
                        var bot_tm_color = "";
                        var bot_dp_url = "";

                        @if (appinfo.AppSettings != null)
                        {
                            bot_name_txt = settings.Name;
                            bot_wc_msg = settings.WelcomeMessage;
                            bot_tm_color = settings.ThemeColor;
                            bot_dp_url = settings.DpUrl;


                        }
                        <div class="btnarea">
                            <button class="ebbtn eb_btn-sm eb_btngreen " id="updateBotAppearance">Update</button>
                        </div>
                        <div class=" botappDashboard col-md-12 col-lg-12 col-xs-12 col-sm-12">
                            <ul class="nav nav-tabs " id="botsteeings" role="tablist">
                                <li class="nav-item active">
                                    <a class="nav-link active" id="botconfig-tab" data-toggle="tab" href="#themeconfig" role="tab" aria-controls="botconfig" aria-selected="true">Theme</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="botcss-tab" data-toggle="tab" href="#botcss" role="tab" aria-controls="botcss" aria-selected="false">Css</a>
                                </li>
                            </ul>

                            <div class="tab-content">
                                <div class="tab-pane active" id="themeconfig" role="tabpanel" aria-labelledby="">
                                    <div class="  col-md-6 col-lg-6  col-sm-12 botappConfig">


                                        <div class="col-sm-12 col-md-12 col-lg-12 botSetng">
                                            <label>DP Url:</label>

                                            <div class="input-group">
                                                <input type="text" class="form-control " id="bot_dp_url" value="@bot_dp_url">
                                                <div class="input-group-btn">
                                                    <button id="btnSelectDpClipart" class="btn btn-info" title="Select from Clipart" onclick="$('#AppDB_BotDemoDp').modal('show');">Select</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 col-md-12 col-lg-12 botSetng">
                                            <div class="form-check mrg10btm">
                                                <label>
                                                    <input class="form-check-input" name="Use_Sol_logo" type="checkbox" value="1" id="Use_Sol_logo">
                                                    Use solution logo in bot header
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 col-md-12 col-lg-12 botSetng">
                                            <label>Theme Colour:</label>
                                            <input type="color" class="form-control botclr " id="bot_tm_color" style=" width: 20%;" value="@bot_tm_color">
                                        </div>
                                        <div class="col-sm-12 col-md-12 col-lg-12 botSetng">
                                            <div class="form-group mrg0">
                                                <label for="ebfont_lst">Select Font:</label>
                                                <select class="form-control" id="ebfont_lst">
                                                    <option disabled="disabled" value="" selected>Select...</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 col-md-12 col-lg-12 botSetng">
                                            <label for="ebfont_size"></label>
                                            <div class="form-group">
                                                <input type="number" class="form-control" id="ebfont_size" aria-describedby="fntsz_hlp">
                                                <small id="fntsz_hlp" class="form-text text-muted">Enter value in pixel </small>
                                            </div>
                                        </div>
                                        <div class="col-sm-12 col-md-12 col-lg-12 botSetng">
                                            <div class="form-check mrg10btm">
                                                <label>
                                                    <input class="form-check-input" name="botheadr" type="checkbox" value="1" id="headerIcon">
                                                    Bot header icon
                                                </label>
                                            </div>
                                            <div class="form-check mrg10btm">
                                                <label>
                                                    <input class="form-check-input" name="botheadr" type="checkbox" value="1" id="headerSubtxt">
                                                    Bot header subtext
                                                </label>
                                            </div>
                                        </div>

                                        <div id="AppDB_BotDemoDp" class="modal fade" role="dialog">
                                            <div class="modal-dialog" style="width:445px">
                                                <div class="modal-content">
                                                    <div class="modal-header" style="">
                                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                        <div>
                                                            <div style="margin-left:10px ; display:inline-block"> <h4 class="modal-title">Bot DP Clip Art</h4> </div>
                                                        </div>
                                                    </div>
                                                    <div class="modal-body" id="dp_modal" style="height:185px">
                                                        <div class="demodpdiv" style=" background:url('../images/demobotdp1.png')center center no-repeat" onclick="clickOnDemoDp('../images/demobotdp1.png')"></div>
                                                        <div class="demodpdiv" style=" background:url('../images/demobotdp2.png')center center no-repeat" onclick="clickOnDemoDp('../images/demobotdp2.png')"></div>
                                                        <div class="demodpdiv" style=" background:url('../images/demobotdp3.png')center center no-repeat" onclick="clickOnDemoDp('../images/demobotdp3.png')"></div>
                                                        <div class="demodpdiv" style=" background:url('../images/demobotdp4.png')center center no-repeat" onclick="clickOnDemoDp('../images/demobotdp4.png')"></div>
                                                        <div class="demodpdiv" style=" background:url('../images/demobotdp5.png')center center no-repeat" onclick="clickOnDemoDp('../images/demobotdp5.png')"></div>
                                                        <div class="demodpdiv" style=" background:url('../images/demobotdp6.png')center center no-repeat" onclick="clickOnDemoDp('../images/demobotdp6.png')"></div>
                                                    </div>
                                                    <div class="modal-footer" style="">
                                                        <button type="button" class="btn btn-default" id="dpBrowse" data-dismiss="modal">Browse</button>
                                                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="  col-md-6 col-lg-6  col-sm-12 botappConfig">
                                        <div class=" row botSetng">

                                            <div class="col">
                                                <label>Background Type:</label>
                                                <div class="col">
                                                    <label class="radio-inline">
                                                        <input type="radio" name="bgradio" id="rdo_bg_clr" value="bg_clr" checked>Background Color
                                                    </label>
                                                    <label class="radio-inline">
                                                        <input type="radio" name="bgradio" id="rdo_bg_grdnt" value="bg_grdnt">Background Gradient
                                                    </label>
                                                    <label class="radio-inline">
                                                        <input type="radio" name="bgradio" id="rdo_bg_img" value="bg_img">Background Image
                                                    </label>
                                                </div>


                                                <div class="col">
                                                    <div class="col-md-12 col-lg-12  col-sm-12 bg_cont" hidden id="bg_clr">
                                                        <div class="col" style=" width: 25%;">
                                                            <input type="color" class="form-control  " id="bot_bg_clr" value="#ffffff">
                                                        </div>
                                                    </div>
                                                    <div class="col bg_cont" hidden id="bg_grdnt">
                                                        <div class="form-group">
                                                            <input type="text" class="form-control" id="bot_bg_grdnt" aria-describedby="bg_grdnt_hlp" placeholder="eg: linear-gradient(45deg, #FA8BFF 0%, #2BD2FF 52%, #2BFF88 90%)">
                                                            <small id="bg_grdnt_hlp" class="form-text text-muted">Enter only gradient value </small>
                                                        </div>
                                                        <div class="btnarea">
                                                            <button class="btn btn-info btn-sm" onclick="$('#grdntgenerator').modal('show');"> Gradient generator</button>
                                                        </div>

                                                    </div>
                                                    <div class="col bg_cont" hidden id="bg_img">
                                                        <div class=" input-group">
                                                            <input type="text" class="form-control " id="bot_bg_url">
                                                            <div class="input-group-btn">
                                                                <button id="bgimg_btn" class="btn btn-info">Browse</button>
                                                            </div>
                                                        </div>
                                                        <div class="col imgPrvwCont" hidden id="imgPrvwCont">
                                                            <img src="#" id="bgImgPreview" class="imgPrevw">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div id="grdntgenerator" class="modal fade" role="dialog">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header" style="">
                                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                        <div>
                                                            <div style="margin-left:10px ; display:inline-block"> <h4 class="modal-title">Gradient generator</h4> </div>
                                                        </div>
                                                    </div>
                                                    <div class="modal-body">
                                                        <div id="grdnt_txt">

                                                        </div>
                                                    </div>
                                                    <div class="modal-footer" style="">
                                                        <button type="button" id="grdntmodalbtn" class="btn btn-default">Ok</button>
                                                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div class="tab-pane botcssConfig" id="botcss" role="tabpanel" aria-labelledby="">
                                    <div class="col-md-2 col-lg-2 col-sm-3 cssconfig">
                                        <ul class="nav nav-tabs tabs-left" id="cssconfigUl" role="tablist">
                                            <li class="nav-item active">
                                                <a class="nav-link active" id="bot_header_li" data-toggle="tab" href="#BOT_HEADER_PART" role="tab" aria-controls="bot_header" aria-selected="true">Bot header</a>
                                            </li>
                                            <li class="nav-item ">
                                                <a class="nav-link " id="bot_headerIcon_li" data-toggle="tab" href="#BOT_HEADER_ICON_CONT" role="tab" aria-controls="bot_headerIcon" aria-selected="false">Bot header icon Container</a>
                                            </li>
                                            <li class="nav-item ">
                                                <a class="nav-link " id="bot_header_img_li" data-toggle="tab" href="#BOT_HEADER_IMAGE" role="tab" aria-controls="bot_header_img" aria-selected="false">Bot header icon</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" id="botAppName_li" data-toggle="tab" href="#BOT_APP_NAME" role="tab" aria-controls="botAppName" aria-selected="false">Header text</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" id="botheadersubtxt_li" data-toggle="tab" href="#BOT_HEADERSUBTEXT" role="tab" aria-controls="botheadersubtxt" aria-selected="false">Header Subtext</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" id="botIframeCss_li" data-toggle="tab" href="#BOT_IFRAME_CSS" role="tab" aria-controls="botIframeCss" aria-selected="false">Iframe Container</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" id="botChatBtn_li" data-toggle="tab" href="#BOT_CHAT_BUTTON" role="tab" aria-controls="botChatBtn" aria-selected="false">Chat head Container</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" id="botImgCont_li" data-toggle="tab" href="#BOT_IMAGE_CONT" role="tab" aria-controls="botImgCont" aria-selected="false">Chat head Image Container</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" id="botBtnImg_li" data-toggle="tab" href="#BOT_BUTTON_IMAGE" role="tab" aria-controls="botBtnImg" aria-selected="false">Chat head Image</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" id="botCloseBtn_li" data-toggle="tab" href="#BOT_CLOSE_BUTTON" role="tab" aria-controls="botCloseBtn" aria-selected="false">Bot close button</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" id="botMax_btn" data-toggle="tab" href="#BOT_MAXIMIZE_BUTTON" role="tab" aria-controls="botMax_btn" aria-selected="false">Bot maximize button</a>
                                            </li>
                                        </ul>
                                    </div>

                                    <div class="col-md-10 col-lg-10 col-sm-9 configcss">
                                        <div class="tab-content" id="configcssTabContent">
                                            <div class="tab-pane active" id="BOT_HEADER_PART" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane" id="BOT_HEADER_ICON_CONT" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane" id="BOT_HEADER_IMAGE" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane " id="BOT_APP_NAME" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane " id="BOT_HEADERSUBTEXT" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane " id="BOT_IFRAME_CSS" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane " id="BOT_CHAT_BUTTON" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane " id="BOT_IMAGE_CONT" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane " id="BOT_BUTTON_IMAGE" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane " id="BOT_CLOSE_BUTTON" role="tabpanel" aria-labelledby="">

                                            </div>
                                            <div class="tab-pane " id="BOT_MAXIMIZE_BUTTON" role="tabpanel" aria-labelledby="">

                                            </div>
                                        </div>

                                    </div>
                                </div>

                            </div>
                        </div>

                    }
                </div>
                <div class="tab-pane" id="home" role="tabpanel">



                    @if (appinfo.AppType == 3)
                    {
                        EbBotSettings settings = ViewBag.AppSettings;
                        var bot_name_txt = appinfo.Name;
                        var bot_wc_msg = "";
                        var bot_tm_color = "";
                        var bot_dp_url = "";

                        @if (appinfo.AppSettings != null)
                        {
                            bot_name_txt = settings.Name;
                            bot_wc_msg = settings.WelcomeMessage;
                            bot_tm_color = settings.ThemeColor;
                            bot_dp_url = settings.DpUrl;


                        }
                        <div class="btnarea">
                            <button class="ebbtn eb_btn-sm eb_btngreen " id="updateBotSettings">Update</button>
                        </div>
                        <div class=" botappDashboard col-md-12 col-lg-12 col-xs-12 col-sm-12">
                            <ul class="nav nav-tabs " id="botConfigSettings" role="tablist">
                                <li class="nav-item active">
                                    <a class="nav-link active" id="botconfig-tab" data-toggle="tab" href="#botconfig" role="tab" aria-controls="botconfig" aria-selected="true">Bot Configuration</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="botuserauth-tab" data-toggle="tab" href="#botuserauth" role="tab" aria-controls="botuserauth" aria-selected="false">User Authentication</a>
                                </li>
                            </ul>

                            <div class="tab-content">
                                <div class="tab-pane active" id="botconfig" role="tabpanel" aria-labelledby="">
                                    <div class="  col-md-6 col-lg-6  col-sm-12 botappConfig">
                                        @*<div class="col-sm-12 col-md-12 col-lg-12 botSetng">
                                                <label>Bot Name: </label>
                                                <div>
                                                    <input class="form-control " type="text" id="bot_name_txt" value="@bot_name_txt">
                                                </div>
                                            </div>*@
                                        <div class="col-sm-12 col-md-12 col-lg-12 botSetng">
                                            <label>Welcome Message: </label>
                                            <textarea class="form-control bot_wcmsg" rows="2" id="bot_wc_msg">@bot_wc_msg</textarea>
                                        </div>
                                        <div class="col-sm-12 col-md-12 col-lg-12 botSetng">
                                            <div class="form-check mrg10btm">
                                                <input class="form-check-input" type="checkbox" value="1" id="useEbtag">
                                                <label class="form-check-label" for="useEbtag">
                                                    Use Expressbase Tagline
                                                </label>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="col-sm-6 col-md-6 col-lg-6 ">
                                        <div class="copyscript">
                                            <button class="btn btn-info btn-sm" onclick="$('#txtemdscript').select(); document.execCommand('copy');"><i style="padding-right:3px" class="fa fa-clipboard"></i> Copy</button>
                                        </div>

                                        <textarea id="txtemdscript" class="srptarea" readonly>
                                        <script type="text/javascript">
                                            (function () {
                                                d = document;
                                                s = d.createElement("script");
                                                s.src = "@jssrc/Bote/Js?id=@appinfo.Id&mode=s";
                                                s.async = 1;
                                                d.getElementsByTagName("head")[0].appendChild(s);
                                            })();
                                        </script>
                                    </textarea>

                                    </div>
                                </div>
                                <div class="tab-pane botUserAuth" id="botuserauth" role="tabpanel" aria-labelledby="">
                                    <div class="col-md-2 col-lg-2 col-sm-3 userAuthConfig">
                                        <label>User authentication type</label>
                                        <div class="radio">
                                            <label><input type="radio" id="publicUsers" name="userAuthType" checked>Public/Anonymous Users</label>
                                        </div>
                                        <div class="radio">
                                            <label><input type="radio" id="internalUsers" name="userAuthType">Internal Users</label>
                                        </div>
                                    </div>

                                    <div class="col-md-10 col-lg-10 col-sm-9 configUserAuth">
                                        <div class="" id="anonymousLoginCont">
                                            <div class="" id="anonymousLogin">
                                                <div class="selauth">
                                                    <label>Anonymous user Authentication methods</label>
                                                    <div class="form-check mrg10btm">
                                                        <label class="nrmfntsiz">
                                                            <input class="form-check-input" name="authtype" type="checkbox" value="1" id="email_anony">
                                                            Email
                                                        </label>
                                                    </div>

                                                    <div class="form-check mrg10btm">
                                                        <label class="nrmfntsiz">
                                                            <input class="form-check-input" name="authtype" type="checkbox" value="1" id="phone_anony">
                                                            Phone
                                                        </label>
                                                    </div>
                                                    <div class="form-check mrg10btm">
                                                        <label class="nrmfntsiz">
                                                            <input class="form-check-input" name="authtype" type="checkbox" value="1" id="fb_anony">
                                                            Facebook
                                                        </label>
                                                    </div>
                                                    <div class="form-inline">
                                                        <label for="fbAppidtxt" class="nrmfntsiz">Facebook App ID</label>
                                                        <input type="text" class="form-control" style="margin-left:15px" name="fbAppidtxt" id="fbAppidtxt" />
                                                    </div>
                                                    <div class="form-inline">
                                                        <label for="fbAppversn" class="nrmfntsiz">Facebook version</label>
                                                        <input type="text" class="form-control" style="margin-left:10px" name="fbAppversn" placeholder="eg: v1.0" id="fbAppversn" />
                                                    </div>
                                                </div>
                                                <div class="selauth">
                                                    <label>Additional optional</label>

                                                    <div class="form-check mrg10btm">
                                                        <label class="nrmfntsiz">
                                                            <input class="form-check-input" type="checkbox" value="1" id="name_anony">
                                                            Ask for name
                                                        </label>
                                                    </div>
                                                </div>

                                            </div>

                                        </div>
                                        <div class="" id="internalLoginCont" hidden>
                                            <div class="" id="internalLogin">
                                                <div class="selauth">
                                                    <label>Internal user Authentication methods</label>
                                                    <div class="radio">
                                                        <label><input type="radio" id="pswrd_based" name="internalAuthType" checked>Password Based</label>
                                                    </div>
                                                    <div class="radio">
                                                        <label><input type="radio" id="otp_based" name="internalAuthType">OTP based</label>
                                                    </div>
                                                </div>


                                            </div>

                                        </div>

                                    </div>
                                </div>

                            </div>
                        </div>

                    }
                    else if (appinfo.AppType == 2)
                    {
                        EbMobileSettings MobSettings = (ViewBag.AppSettings as EbMobileSettings);

                        <div class="appdash_typedmob_readerWraper">
                            <div class="appdash_readerinner">
                                <div class="body" id="reader_body" style="display:flex;flex-flow:column;">
                                    <table style="width:100%;margin-top:10px;" class="import_reftable">
                                        <thead>
                                            <tr>
                                                <th>Table Name</th>
                                                <th>Name</th>
                                                <th style="width:50px;">
                                                    <a class="obj-selector-btn pull-right" id="add_readers" data-target="#import_data_mdl" data-toggle="modal">...</a>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="import_reftable_body">
                                            @{
                                                if (MobSettings.DataImport.Count > 0)
                                                {
                                                    foreach (DataImportMobile di in MobSettings.DataImport)
                                                    {
                                                        <tr>
                                                            <td><input type="text" class="import_reftable_input" value="@di.TableName" name="@(di.RefId + "_input")" /></td>
                                                            <td>
                                                                <a href="/Eb_Object/Index?objid=@di.RefId.Split("-")[3]&objtype=@di.RefId.Split("-")[2]" target="_blank">@di.DisplayName</a>
                                                            </td>
                                                            <td class="text-center"><button class="rm_refbtn pull-right" ref="@di.RefId"><i class="fa fa-close"></i></button></td>
                                                        </tr>
                                                    }
                                                }
                                                else
                                                {
                                                    <tr class="empty_tr">
                                                        <td colspan="3" style="text-align:center">empty</td>
                                                    </tr>
                                                }
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="appdash-mobile-menuvalidator">
                            <h4>Menu Before Render</h4>
                            <div class="menuvalidator-inner">
                                <div class="meta" id="menuload-api-meta">
                                    @{
                                        string apiText = "Not selected";
                                        if (MobSettings.MenuApi != null)
                                        {
                                            apiText = $"{MobSettings.MenuApi.DisplayName} (../{MobSettings.MenuApi.Name}/{MobSettings.MenuApi.Version}/json)";
                                        }
                                        <span>@apiText</span>
                                    }
                                </div>
                                <a class="obj-selector-btn" data-target="#mobile-preloadmenu_mdl" data-toggle="modal">
                                    ...
                                </a>
                            </div>
                        </div>

                        <div class="appdash-mobile-menuvalidator">
                            <h4>DashBoard</h4>
                            <div class="menuvalidator-inner">
                                <div class="meta" id="mobile-dash-refid">
                                    @{
                                        string dashboardText = "Not selected";

                                        if (!string.IsNullOrEmpty(MobSettings.DashBoardRefId))
                                        {
                                            dashboardText = MobSettings.DashBoardRefId;

                                            if (list.TryGetValue(13, out var collection) && collection.Objects != null)
                                            {
                                                ObjWrap obj = collection.Objects.Find(x => x.Refid == MobSettings.DashBoardRefId);
                                                if (obj != null)
                                                {
                                                    dashboardText = obj.DisplayName + " (" + MobSettings.DashBoardRefId + ")";
                                                }
                                            }
                                        }
                                        <span>@dashboardText</span>
                                    }
                                </div>
                                <a class="obj-selector-btn" data-target="#mobile-dashboard_mdl" data-toggle="modal">
                                    ...
                                </a>
                            </div>
                        </div>

                        <div class="appseting-footer" style="margin-top:2em;width:50%">
                            <button class="ebbtn eb_btn-sm eb_btnblue pull-right" id="save-appsettings-btn">
                                <i class="fa fa-floppy-o" style="margin-right:5px;"></i> Save App Settings
                            </button>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <div id="newObjectmdl" class="modal fade newObjectmdl" role="dialog">
        <div class="modal-dialog h-100 w-100" style="margin:0;display: flex;justify-content: center;align-items: center;">
            <div class="modal-content" style="width:90%;height:90%;display: flex;flex-direction: column;">
                <div class="modal-header" style="border-style:none">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Create new Object</h4>
                </div>
                <div class="modal-body" style="flex:1;overflow-y:auto;">
                    <div class="eb-newobj-mdlbdy">
                        @{
                            List<int> cs = new List<int> { 23, 7, 25 };

                            foreach (EbObjectType objectType in EbObjectTypes.Enumerator)
                            {
                                if (objectType.IsAvailableIn(apptype))
                                {
                                    string url = string.Empty, _class = string.Empty;
                                    if (cs.Contains(objectType.IntCode))
                                    {
                                        url = "#";
                                        _class = "eb-newobj-comingsoon";
                                    }
                                    else
                                    {
                                        url = "../Eb_Object/Index?objid=null&objtype=" + objectType.IntCode;
                                    }
                                    <div class="eb-newobjtile">
                                        <a class="eb-newobjtile-inner @_class" href="@url">
                                            <div class="icon">
                                                <span class="fa @objectType.Icon"></span>
                                            </div>
                                            <div class="name">@objectType.Alias</div>
                                        </a>
                                    </div>
                                }
                            }
                        }
                    </div>
                </div>
                <div class="modal-footer" style="border-style:none">
                    <button type="button" class="btn eb_btnblue" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>

    <div id="import_data_mdl" class="modal fade import_data_mdl" role="dialog">
        <div class="modal-dialog h-100 w-100" style="margin:0;display: flex;justify-content: center;align-items: center;">
            <div class="modal-content" style="min-width:40%;height:70%;display: flex;flex-direction: column;">
                <div class="modal-header" style="border-style:none">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Import Data</h4>
                </div>
                <div class="modal-body" style="flex:1;overflow-y:auto;">
                    @{
                        if (appinfo.AppType == 2)
                        {
                            <div class="import_data_mdl_mdlbdy">
                                <div class="import_data_cols import_data_objects w-100">
                                    <label>DataReader</label>
                                    <div class="import_data_cols_inner">
                                        @{
                                            if (list.ContainsKey(2))
                                            {
                                                <div class="import_obj_expand" id="import_expand_2">
                                                    @if (!list[2].Objects.Any())
                                                    {
                                                        <div class="empty_list">empty</div>
                                                    }

                                                    @foreach (ObjWrap oball in list[2].Objects)
                                                    {
                                                        if (oball.IsCommitted)
                                                        {
                                                            <div class="import_obj_expand_objlinks">
                                                                <input type="checkbox" name="importcheckbox" display-name="@oball.DisplayName" refid="@oball.Refid" />
                                                                <div class="">
                                                                    @oball.DisplayName
                                                                </div>
                                                            </div>
                                                        }
                                                    }
                                                </div>
                                            }
                                        }
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>
                <div class="modal-footer" style="border-style:none">
                    <button type="button" class="btn eb_btnblue" id="import_refsave">Add</button>
                </div>
            </div>
        </div>
    </div>

    <div id="mobile-preloadmenu_mdl" class="modal fade import_data_mdl" role="dialog">
        <div class="modal-dialog h-100 w-100" style="margin:0;display: flex;justify-content: center;align-items: center;">
            <div class="modal-content" style="min-width:40%;height:70%;display: flex;flex-direction: column;">
                <div class="modal-header" style="border-style:none">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Mobile Menu Preload</h4>
                </div>
                <div class="modal-body" style="flex:1;overflow-y:auto;">
                    @{
                        if (appinfo.AppType == 2)
                        {
                            <div class="import_data_mdl_mdlbdy">
                                <div class="import_data_cols import_data_objects w-100">
                                    <div style="display:flex;justify-content:space-between;">
                                        <label>Api</label> <a id="menu-api-reset">Clear Selection</a>
                                    </div>
                                    <div class="import_data_cols_inner">
                                        @{
                                            if (list.ContainsKey(20))
                                            {
                                                <div class="import_obj_expand" id="preloadmenu_20">
                                                    @if (!list[20].Objects.Any())
                                                    {
                                                        <div class="empty_list">empty</div>
                                                    }

                                                    @foreach (ObjWrap oball in list[20].Objects)
                                                    {
                                                        if (oball.IsCommitted)
                                                        {
                                                            string selected = string.Empty;

                                                            EbMobileSettings settings = (EbMobileSettings)ViewBag.AppSettings;

                                                            if (settings.MenuApi != null && settings.MenuApi.RefId == oball.Refid)
                                                            {
                                                                selected = "selected";
                                                            }

                                                            <div class="import_obj_expand_objlinks @selected" version="@oball.VersionNumber" display-name="@oball.DisplayName" refid="@oball.Refid" name="@oball.ObjName">
                                                                @oball.DisplayName
                                                            </div>
                                                        }
                                                    }
                                                </div>
                                            }
                                        }
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>
    </div>

    <div id="mobile-dashboard_mdl" class="modal fade import_data_mdl" role="dialog">
        <div class="modal-dialog h-100 w-100" style="margin:0;display: flex;justify-content: center;align-items: center;">
            <div class="modal-content" style="min-width:40%;height:70%;display: flex;flex-direction: column;">
                <div class="modal-header" style="border-style:none">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">DashBoard</h4>
                </div>
                <div class="modal-body" style="flex:1;overflow-y:auto;">
                    @{
                        if (appinfo.AppType == 2)
                        {
                            <div class="import_data_mdl_mdlbdy">
                                <div class="import_data_cols import_data_objects w-100">
                                    <div style="display:flex;justify-content:space-between;">
                                        <label>DashBoard</label> <a id="mobiledashboard-reset">Clear Selection</a>
                                    </div>
                                    <div class="import_data_cols_inner">
                                        @{
                                            if (list.ContainsKey(13))
                                            {
                                                <div class="import_obj_expand">
                                                    @if (!list[13].Objects.Any())
                                                    {
                                                        <div class="empty_list">empty</div>
                                                    }

                                                    @foreach (ObjWrap oball in list[13].Objects)
                                                    {
                                                        if (oball.IsCommitted)
                                                        {
                                                            string selected = string.Empty;

                                                            EbMobileSettings settings = (EbMobileSettings)ViewBag.AppSettings;

                                                            if (settings.DashBoardRefId == oball.Refid)
                                                            {
                                                                selected = "selected";
                                                            }

                                                            <div class="import_obj_expand_objlinks @selected" version="@oball.VersionNumber" display-name="@oball.DisplayName" refid="@oball.Refid" name="@oball.ObjName">
                                                                @oball.DisplayName
                                                            </div>
                                                        }
                                                    }
                                                </div>
                                            }
                                        }
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>
            </div>
        </div>
    </div>
</div>

@section JsCode{
    <script>
       let appsetting = @Html.Raw(JsonConvert.SerializeObject(ViewBag.AppSettings));
       let appinfo= @Html.Raw(JsonConvert.SerializeObject(ViewBag.AppInfo));
       let ebfont_lst = @Html.Raw(JsonConvert.SerializeObject(ViewBag.EbfontLst));

       var adash = new AppDashBoard(@appinfo.Id,@appinfo.AppType, appsetting,appinfo,ebfont_lst);
       $('#bgImgPreview').attr('onerror', `this.onerror=null;this.src='/images/imageplaceholder.png'`);

    function clickOnDemoDp(path) {
        $('#AppDB_BotDemoDp').modal('hide');
        $('#bot_dp_url').val(path);
        $('#bot_dp_url').attr("dpRefid", "");
    }
    </script>
}
