@using ExpressBase.Objects.ServiceStack_Artifacts
@using ExpressBase.Common
@{
    Layout = "~/Views/Shared/LayoutInner.cshtml";
}
@{
    List<AppStore> _appList = ViewBag.StoreApps;
}
@section StyleSheet{
    <style>
        .coTBx-apStr-bdy {
            display: flex;
            flex-flow: row wrap;
            padding: 0 10px;
        }

            .coTBx-apStr-bdy .apPtiLe {
                padding: 10px;
                width: 33.3%;
            }

                .coTBx-apStr-bdy .apPtiLe .apTileInner {
                    border: 1px solid #ccc;
                    padding: 20px;
                    border-radius: 4px;
                }

                    .coTBx-apStr-bdy .apPtiLe .apTileInner .apTileInner-heading {
                        margin-top: 0;
                        color: #333;
                        font-weight: 300;
                        font-size: 20px;
                        text-decoration: none;
                    }

                        .coTBx-apStr-bdy .apPtiLe .apTileInner .apTileInner-heading:hover {
                            text-decoration: none;
                            color: #4987fb;
                            font-weight: 400;
                        }

        .apPtiLe .apTileInner-bdy-footer {
            margin-top: 20px;
        }

            .apPtiLe .apTileInner-bdy-footer .install-btn {
                color: #368c03;
                font-weight: 500;
            }

            .apPtiLe .apTileInner-bdy-footer .share-btn {
                color: #4a80e4;
                font-weight: 500;
            }
    </style>
}
<div class="row s-dash-container h-100">
    <div class="s-dash-workplace tenant_workpane">
        <div class="col-md-12 col-lg-12 col-sm-12 s-dash-solution-desc">
            <div class="col-md-6 pd-0">
                <h4 class="mr-t-0 mr-b-0">My Store <span class="privcount"></span> </h4>
            </div>
            <div class="col-md-6 pd-0 s-dash-btnwraper">
                <div class="input-group eb-search-box" style="margin-left: 15px;">
                    <span class="input-group-addon"><i class="fa fa-search"></i></span>
                    <input type="text" id="appSearch" class="form-control" placeholder="Search...">
                </div>
                <a href='@Url.Action("AppStorePublic","Ext")' target="_blank" class="ebbtn eb_btnblue pull-right eb_btn-sm new_sol_lk">Public Apps</a>
            </div>
        </div>
        <div class="col-md-12 pd-0 s-dash-workplace-tabs">
            <div class="coTBx-apStr-bdy w-100" id="app-wrapperOuter">
                @{
                    int privcount = 0;
                    if (_appList != null)
                    {
                        @for (int i = 0; i < _appList.Count; i++)
                        {
                            var apptype = (EbApplicationTypes)_appList[i].AppType;

                            string desc = String.IsNullOrEmpty(_appList[i].Description) ? "No Description" : _appList[i].Description;
                            if (_appList[i].Status == 1)
                            {
                                privcount = privcount + 1;
                                <div class="apPtiLe">
                                    <div class="apTileInner">
                                        <a href="@Url.Action("AppDashBoard", "Dev" , new { Id=_appList[i].Id, Type=_appList[i].AppType })" class="apTileInner-bdy">
                                            <h3 class="apTileInner-heading"><i class="fa @_appList[i].Icon"></i> @_appList[i].Name</h3>
                                        </a>
                                        <p>@desc</p>
                                        <div class="apTileInner-bdy-footer">
                                            <a class="install-btn" href="../ImportExport/Import?Id=@(_appList[i].Id)">
                                                <i class="fa fa-download" aria-hidden="true"></i> Install
                                            </a>
                                            <a class="share-btn pull-right" href="../ImportExport/ShareToPublic?id=@(_appList[i].Id)">
                                                <i class="fa fa-share-alt" aria-hidden="true"></i> Share to Public
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            }
                        }

                    }
                }
            </div>
        </div>
    </div>
</div>
@section JsCode{
    <script>
        window.ebcontext.header.setName("My Store");
         if ('@ViewBag.Msg') {
            EbMessage("show", { Message: "@ViewBag.Msg", AutoHide: true });
        }
        $(document).ready(function () {
            $(".privcount").text("(@privcount)");
            $("#appSearch").off("keyup").on("keyup", function (e) {
                var srch = $(e.target).val().toLowerCase();
                $.each($("#app-wrapperOuter").find(".apPtiLe"), function (i, obj) {
                    var cmpstr = $(obj).find('.apTileInner-heading').text().toLowerCase();
                    if (cmpstr.indexOf(srch) !== -1) {
                        $(obj).show();
                    }
                    else
                        $(obj).hide();
                });
            });

        });
        $('#share').on('click', function () {});
    </script>
}

