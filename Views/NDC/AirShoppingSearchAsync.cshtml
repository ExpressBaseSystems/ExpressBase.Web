@{
    @using Newtonsoft.Json;
    var OfferResponse = Html.Raw(JsonConvert.SerializeObject(ViewBag.XmlResponse1));
    var OfferResponse2 = Html.Raw(JsonConvert.SerializeObject(ViewBag.XmlResponse2));
}
@{
    Layout = "~/Views/Shared/_Layout1.cshtml";
}

<div id="mydiv">
    <div class="airlne_container">
        <b>Sort By :</b>
        <input type="radio" name="Sort" value="dtime"> <i> Departure Time</i>
        <input type="radio" name="Sort" value="atime"> <i>Arrival Time</i>
        <input type="radio" name="Sort" value="price"> <i>Price</i>
    </div>
</div>

<style>
    /*card*/
    .airlne_container {
        width: 100%;
        background: #fafafa;
        float: left;
        padding: 10px;
        border-radius: 10px;
        margin-bottom: 15px;
        box-shadow: 0 2px 2px 0 rgba(0,0,0,0.14), 0 3px 1px -2px rgba(0,0,0,0.12), 0 1px 5px 0 rgba(0,0,0,0.2);
        font-family: open sans;
    }

    .airline_head {
        width: 100%;
        height: 30px;
        font-weight: bold;
    }

    .Depart_time, .Arrive_time {
        width: 23.3%;
        float: left;
    }

    .Duration_time {
        width: 23.3%;
        float: left;
    }

    ._Price {
        width: 30%;
        float: left;
        text-align: right;
        font-weight: bold;
        color: #356fda;
    }

    ._head_inner {
        background: #a0a0a0;
        color: white;
        width: 85%;
        border-radius: 4px;
        text-align: center;
    }

    ._head_body_inner {
        width: 85%;
        text-align: center;
        padding-top: 7px;
    }

    .btn_book {
        background: #356fda;
        color: white;
        border-radius: 20px;
    }

    ._logo_air {
        height: 100%;
        border-radius: 50%;
    }

        ._logo_air img {
            height: 25px;
            border-radius: 50%;
            width: 25px;
        }
</style>

<script>
   
    var jsonobj = JSON.parse(@OfferResponse);
    var jsonobj2 = JSON.parse(@OfferResponse2);
    var newobj = [];
    var ownerdata = [];
    ownerdata.push({ code: "XQ", Name: "Sun Express", Logo: "https://worldairlinenews.files.wordpress.com/2013/11/sunexpress-logo-1.jpg" });
    ownerdata.push({ code: "JW", Name: "Vanilla Air", Logo: "https://www.seatlink.com/images/logos/no-text/sm/vanilla-air.png" });

    var owner = jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:OffersGroup"]["ns2:AirlineOffers"]["ns2:Owner"];
    //var price = jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:OffersGroup"]["ns2:AirlineOffers"]["ns2:AirlineOffer"]["ns2:PricedOffer"]["ns2:OfferPrice"]["ns2:FareDetail"]["ns2:FareComponent"]["ns2:PriceBreakdown"]["ns2:Price"]["ns2:BaseAmount"]["#text"];
    //var arrtime = jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]["ns2:Arrival"]["ns2:Time"];
    //var deptime = jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]["ns2:Departure"]["ns2:Time"];
    //var duration = jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]["ns2:FlightDetail"]["ns2:FlightDuration"]["ns2:Value"];
    var price = Array.isArray(jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:OffersGroup"]["ns2:AirlineOffers"]["ns2:AirlineOffer"]) ? jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:OffersGroup"]["ns2:AirlineOffers"]["ns2:AirlineOffer"][0]["ns2:PricedOffer"]["ns2:OfferPrice"]["ns2:RequestedDate"]["ns2:PriceDetail"]["ns2:BaseAmount"]["#text"] : jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:OffersGroup"]["ns2:AirlineOffers"]["ns2:AirlineOffer"]["ns2:PricedOffer"]["ns2:OfferPrice"]["ns2:RequestedDate"]["ns2:PriceDetail"]["ns2:BaseAmount"]["#text"];
    var arrtime = Array.isArray(jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]) ? jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"][0]["ns2:Arrival"]["ns2:Time"] : jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]["ns2:Arrival"]["ns2:Time"];
    var deptime = Array.isArray(jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]) ? jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"][0]["ns2:Departure"]["ns2:Time"] : jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]["ns2:Departure"]["ns2:Time"];
    var duration = Array.isArray(jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]) ? jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"][0]["ns2:FlightDetail"]["ns2:FlightDuration"]["ns2:Value"] : jsonobj["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]["ns2:FlightDetail"]["ns2:FlightDuration"]["ns2:Value"];


    var owner2 = jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:OffersGroup"]["ns2:AirlineOffers"]["ns2:Owner"];
    var price2 = Array.isArray(jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:OffersGroup"]["ns2:AirlineOffers"]["ns2:AirlineOffer"]) ? jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:OffersGroup"]["ns2:AirlineOffers"]["ns2:AirlineOffer"][0]["ns2:PricedOffer"]["ns2:OfferPrice"]["ns2:RequestedDate"]["ns2:PriceDetail"]["ns2:BaseAmount"]["#text"] : jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:OffersGroup"]["ns2:AirlineOffers"]["ns2:AirlineOffer"]["ns2:PricedOffer"]["ns2:OfferPrice"]["ns2:RequestedDate"]["ns2:PriceDetail"]["ns2:BaseAmount"]["#text"];
    var arrtime2 = Array.isArray(jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]) ? jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"][0]["ns2:Arrival"]["ns2:Time"] : jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]["ns2:Arrival"]["ns2:Time"];
    var deptime2 = Array.isArray(jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]) ? jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"][0]["ns2:Departure"]["ns2:Time"] : jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]["ns2:Departure"]["ns2:Time"];
    var duration2 = Array.isArray(jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]) ? jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"][0]["ns2:FlightDetail"]["ns2:FlightDuration"]["ns2:Value"] : jsonobj2["soap:Envelope"]["soap:Body"]["ns2:AirShoppingRS"]["ns2:DataLists"]["ns2:FlightSegmentList"]["ns2:FlightSegment"]["ns2:FlightDetail"]["ns2:FlightDuration"]["ns2:Value"];


    newobj.push({ Depart: deptime, Arrive: arrtime, Duration: duration, Price: price, Airline: getName(owner), Logo: getLogo(owner) });
    newobj.push({ Depart: deptime2, Arrive: arrtime2, Duration: duration2, Price: price2, Airline: getName(owner2), Logo: getLogo(owner2) });

    getAirlines(newobj, $("#mydiv"));

    function getName(ownerid) {
        for (i = 0; i < ownerdata.length; i++)
            if (ownerid === ownerdata[i].code)
                return ownerdata[i].Name
    }

    function getLogo(ownerid) {
        for (i = 0; i < ownerdata.length; i++)
            if (ownerid === ownerdata[i].code)
                return ownerdata[i].Logo
    }


    function getAirlines (obj, $container) {
        if (!$.isEmptyObject(obj))
            this.drawAirlinesList(obj, $container);
    };

    function drawAirlinesList (obj, $container) {
        for (var i = 0; i < obj.length;i++) {
            $container.append(`<div class="airlne_container">
                    <div class="airline_head">
                    <span class="_logo_air"><img class="img-circle" src="${obj[i].Logo}" /></span>
                    ${obj[i].Airline}
                    <span class="_price_val pull-right">${obj[i].Price}</span>
                </div>
                <div class="airline_body">
                    <div class="Depart_time"><div class="_head_inner">Depart</div><div class="_head_body_inner">${obj[i].Depart}</div></div>
                    <div class="Arrive_time"><div class="_head_inner">Arrive</div><div class="_head_body_inner">${obj[i].Arrive}</div></div>
                    <div class="Duration_time"><div class="_head_inner">Duration</div><div class="_head_body_inner">${obj[i].Duration}</div></div>
                    <div class="_Price"><button class="btn btn_book">Book</button></div>
                </div>
            </div>`);
        };
    }
</script>