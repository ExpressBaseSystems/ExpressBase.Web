@using ExpressBase.Objects.ServiceStack_Artifacts;
@using ExpressBase.Common;
@{
    bool fd = false;
}
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js"></script>
<script type="text/javascript" src="~/js/eb_common.js"></script>
<body>
    <div id="fd"></div>
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Modal Header</h4>
                </div>
                <div class="modal-body">
                    @{
                        if (ViewBag.Fd.EbDataSource.FilterDialog != null)
                        {
                            @await Component.InvokeAsync("ParameterDiv", new { paramDiv = ViewBag.Fd.EbDataSource.FilterDialog });
                            fd = true;
                        }
                    }

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="run">Submit</button>
                </div>
            </div>
        </div>
    </div>
    @*<iframe src='../ReportRender/Render?refid=@ViewBag.Refid'></iframe>*@
</body>
<script>
    $(document).ready(function () {

        if ('@fd' ==='True') {
            $("#myModal").modal();
        }
        $("#run").on("click", function () {
            var ParamsArray = [];
            var filter_control_list = $("#all_control_names").val();
            var myarray = filter_control_list.split(',');
            for (var i = 0; i < myarray.length; i++) {
                console.log($("#" + myarray[i]).val());
                var type = $('#' + myarray[i]).attr('data-ebtype');
                var name = $('#' + myarray[i]).attr('name');
                var value = $('#' + myarray[i]).val();
                if (type === '6')
                    value = value.substring(0, 10);
                ParamsArray.push(new fltr_obj(type, name, value));
            }
            $.post('../ReportRender/Render', {
                refid:'@ViewBag.Refid',
                Params: ParamsArray
            });
        });
    });


</script>
<style>
    select.selectpicker {
        display: block;
        margin: 0 auto;
        padding-left: 20px;
    }

    .btn-new {
        background-color: #2A3F54;
    }
</style>